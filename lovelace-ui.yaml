##########################################################################
#                                                                        #
#                              * SETTINGS *                              #
#                                                                        #
##########################################################################

custom_header:
    exceptions:
      - conditions:
          query_string: kiosk
        config:
          kiosk_mode: false

decluttering_templates: !include_dir_merge_named lovelace/decluttering_templates          

button_card_templates:
  header:
    styles:
      card:
        - box-shadow: none
        - border-radius: 0%
        - padding: 0%
        - font-size: 10px
        - text-shadow: 0px 0px 0px black
        - text-transform: capitalize
      icon:
        - width: 15%
        - margin-top: 0%
        - margin-left: 0%
      name:
        - font-size: 16px
        - text-transform: capitalize
        - justify-self: start
        - margin-left: 1%
  standard_button:
    styles:
      card:
        - font-size: 10px
      icon:
        - width: 30%
      name:
        - font-size: 12px
      state:
        - justify-self: start
        - font-size: 10px
        - padding: 0px 5px

  base:
    aspect_ratio: 1/1
    show_state: true
    show_icon: false

  light:
    state: &button_state
      - value: 'on'
        styles:
          card: [background-color: 'rgba(255, 255, 255, 0.8)']
          name: [color: 'rgba(0, 0, 0, 0.6)']
          state: [color: 'rgba(0, 0, 0, 0.6)']
    custom_fields:
      info: >
        [[[ if (entity.state == 'on' && entity.attributes.brightness) {
        const brightness = Math.round(entity.attributes.brightness / 2.54);
        const radius = 20.5; const circumference = radius * 2 * Math.PI; 
        return `<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="${radius}" stroke="#b2b2b2" stroke-width="1.5" fill="none" style="
        transform: rotate(-90deg); transform-origin: 50% 50%; stroke-dasharray: ${circumference}; stroke-dashoffset: ${circumference - brightness / 100 * circumference};" />
        <text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle">${brightness}<tspan font-size="10">%</tspan></text></svg>`; } ]]]
    styles:
      name: &button_styles_name
        [top: 57.7%, left: 11%, position: absolute, line-height: 2vw]
      state: &button_styles_state
        [top: 74%, left: 11%, position: absolute, line-height: 2vw]
      custom_fields:
        info: &circle_pos
          [top: 8.5%, left: 56.2%, width: 3.5vw, position: absolute, letter-spacing: 0.03vw]
      card: &button_styles_card
        [font-family: Sf Display, letter-spacing: 0.05vw, text-rendering: optimizeLegibility, font-weight: 400, color: 'rgba(255, 255, 255, 0.3)', font-size: 1.34vw, 
        background-color: 'rgba(115, 115, 115, 0.2)', border-radius: 0.8vw, box-shadow: none, transition: none]
    tap_action:
      ui_sound: &ui_sound |
        [[[ if (entity.state === 'off' && states['switch.fullykiosk_screensaver'].state === 'off') {
        hass.callService('media_player', 'play_media', {entity_id: 'media_player.tablet', media_content_id: '/local/sound/on.m4a', media_content_type: 'music'}); }
        else if (entity.state === 'on' && states['switch.fullykiosk_screensaver'].state === 'off') {
        hass.callService('media_player', 'play_media', {entity_id: 'media_player.tablet', media_content_id: '/local/sound/off.m4a', media_content_type: 'music'}); } ]]]
      action: toggle
      haptic: light
    hold_action:
      action: call-service
      service: browser_mod.popup
      service_data:
        title: '[[[ return entity.attributes.friendly_name ]]]'
        deviceID: this
        card:
          type: entities
          entities:
            - type: custom:light-popup-card
              entity: '[[[ return entity.entity_id ]]]'
              icon: none
              fullscreen: false
              brightnessWidth: 130px
              brightnessHeight: 360px
              borderRadius: 1.7em
              sliderColor: '#c7c7c7'
              sliderTrackColor: rgba(25, 25, 25, 0.9)
              actionSize: 4.5em
              actionsInARow: 2
              style: |
                #popup {
                  margin: -2.4em 0 1.4em 0; }
                #popup > div.range-holder > input[type=range] {
                  cursor: grab; }
                #brightnessValue {
                  color: rgba(255, 255, 255, 0.8); margin: -1.9em 0 0 0; font-size: 2em; font-weight: 400; 
                  position: absolute; z-index: 100; font-family: SF Display; letter-spacing: 0.02em; pointer-events: none; 
                  mix-blend-mode: difference; text-align:center; width: 3.4em; height: 3.4em; }
                #popup > div.range-holder > input[type=range]::-webkit-slider-thumb {
                  border: 0; eight: 0; width: 0; cursor: grabbing; }
                #popup > div.action-holder > div > div {
                  margin: 0.8em 0.5em -0.8em 0.5em; }
                #popup > div.action-holder > div:last-child > div:last-child > .color {
                  background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 80%), 
                  conic-gradient(rgb(120,39,230), rgb(230,34,231), rgb(228,5,136), rgb(228,25,25), rgb(229,105,30), rgb(232,226,46), 
                  rgb(125,230,41), rgb(52,232,40), rgb(51,231,92), rgb(52,232,224),rgb(32,125,229), rgb(18,39,229), rgb(120,39,230));
                  border-width: 2px; border-color: #e6e6e6; --size: 4.4em !important; }
              actions:
                - service: light.turn_on
                  service_data:
                    entity_id: '[[[ return entity.entity_id ]]]'
                    color_temp: 153
                  color: "#d8d9e1"
                - service: light.turn_on
                  service_data:
                    entity_id: '[[[ return entity.entity_id ]]]'
                    color_temp: 326
                  color: "#d5b08d"
                - service: light.turn_on
                  service_data:
                    entity_id: '[[[ return entity.entity_id ]]]'
                    color_temp: 500
                  color: "#ce944b"
                - service: browser_mod.popup
                  service_data:
                    title: '[[[ return entity.attributes.friendly_name ]]]'
                    deviceID: this
                    card:
                      type: entities
                      show_header_toggle: false
                      entities:
                        - entity: '[[[ return entity.entity_id ]]]'
                          secondary_info: last-changed
                        - type: custom:light-entity-card
                          entity: '[[[ return entity.entity_id ]]]'
                          brightness: false
                          color_temp: true
                          full_width_sliders: true
                          hide_header: true
                          show_slider_percent: true
                          smooth_color_wheel: true
                          consolidate_entities: true

##########################################################################
#                                                                        #
#                              * LOVELACE *                              #
#                                                                        #
##########################################################################

title: Home
views:
  - panel: true
    path: default_view
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            title:
            cards:
              - type: markdown
                content: >
                  # {{ states('sensor.time') }}

                  ## {{ states('sensor.sidebar_day') }}, {{ states('sensor.sidebar_date') }}

                  {{ states('sensor.sidebar_greeting') }} {{ states('sensor.sidebar_weather') }} 

                  {{ states('sensor.sidebar_active') }}
                style:
                  .: |
                    ha-card {
                      --ha-card-background: none !important;
                      box-shadow: none !important;
                    }
                  ha-markdown:
                    $: |
                      h1 {
                        font-size: 50px;
                        font-weight: bold;
                        font-family: Helvetica;
                        letter-spacing: '-0.01em';
                      }
          - type: horizontal-stack
            cards:
              - type: custom:simple-weather-card
                entity: weather.home
                name: " "
                style:
                  .: |
                    ha-card {
                      --ha-card-background: none !important;
                      box-shadow: none !important;
                    }
          - type: horizontal-stack
            cards:
              - type: markdown
                content: |
                  # Home
                style:
                  .: |
                    ha-card {
                      --ha-card-background: none !important;
                      box-shadow: none !important;
                    }
                  ha-markdown:
                    $: |
                      h1 {
                        font-size: 20px;
                        font-weight: bold;
                        font-family: Helvetica;
                        letter-spacing: '-0.01em';
                      }
          - type: horizontal-stack
            cards:            
              - type: custom:decluttering-card
                template: "simple_link"
                variables:
                  - path: kitchen
                  - name: Kitchen
                  - icon: mdi:chef-hat
                  - entity: light.kitchen_lights
              - type: custom:decluttering-card
                template: "simple_link"
                variables:
                  - path: loungeroom
                  - name: Lounge Room
                  - icon: mdi:sofa
                  - entity: light.lounge_room_lamp
              - type: custom:decluttering-card
                template: "simple_link"
                variables:
                  - path: bedroom
                  - name: Bedroom
                  - icon: mdi:heart-outline
                  - entity: light.bedroom_lamps
          - type: horizontal-stack
            cards:
              - type: custom:decluttering-card
                template: "simple_link"
                variables:
                  - path: ollie_room
                  - name: Ollie's Room
                  - icon: mdi:paw
                  - entity: light.ollie_s_lamp
              - type: custom:decluttering-card
                template: "simple_link"
                variables:
                  - path: teddy_room
                  - name: Teddy's Room
                  - icon: mdi:pokeball
                  - entity: light.teddy_s_lamp
          
          - type: custom:swipe-card
            card_width: '185px'
            start_card: 1
            cards:
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: markdown
                        content: |
                          # Kitchen
                        style:
                          .: |
                            ha-card {
                              --ha-card-background: none !important;
                              box-shadow: none !important;
                            }
                          ha-markdown:
                            $: |
                              h1 {
                                font-size: 20px;
                                font-weight: bold;
                                font-family: Helvetica;
                                letter-spacing: '-0.01em';
                              }

                  - type: horizontal-stack
                    cards:
                      - type: custom:button-card
                        entity: light.kitchen_lights
                        name: Kitchen Lights
                        style:
                          width: 10%
                        template: ['base','light']
                      - type: custom:button-card
                        name: Scenes
                        style:
                          width: 10%
                        template: ['base']

                  - type: horizontal-stack
                    cards:
                      - type: custom:mini-media-player
                        entity: media_player.kitchen_display
                        info: scroll
                        artwork: cover
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: markdown
                        content: | 
                          # Lounge Room
                        style:
                          .: |
                            ha-card {
                              --ha-card-background: none !important;
                              box-shadow: none !important;
                            }
                          ha-markdown:
                            $: |
                              h1 {
                                font-size: 20px;
                                font-weight: bold;
                                font-family: Helvetica;
                                letter-spacing: '-0.01em';
                              }

                  - type: horizontal-stack
                    cards:
                      - type: custom:button-card
                        entity: light.lounge_room_lamp
                        style:
                          top: 20.35%
                          left: 30.31%
                          width: 10%
                        custom_fields:
                          icon_hue: &icon_hue >
                            [[[ const state = entity.state === 'on' ? 'animate' : null;
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate{0%{transform: scale(0.85);}20%{transform: scale(1.1);}40%{transform: scale(0.95);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}100%{transform: scale(1);}}.animate{animation: animate 0.8s; transform-origin: center;}</style>
                            <path fill="#9da0a2" d="M27.4 47.3h-4.9s-.7.1-.7.8.4.9.7.9h4.9c.3 0 .7-.1.7-.9s-.7-.8-.7-.8zm3.3-2.9H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9-.1-.8-.9-.8-.9-.8zm0-3H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9-.1-.8-.9-.8-.9-.8zm0-2.9H19.3s-.8 0-.8.8.6.9.8.9h11.5c.2 0 .8-.1.8-.9s-.9-.8-.9-.8zm5.2-23.2c-3.3-5.3-7-5.6-10.9-5.6-3.8 0-8.4.4-10.9 5.6-.1.1-.1.3.1.7.4.8 3.3 7.2 3.2 18.8 0 1.1-.1 1.6 0 1.7 0 .1 0 .7 1.1.7h13c1 0 1-.5 1.1-.7v-1.7c-.1-11.6 2.8-18 3.2-18.8.1-.4.1-.5.1-.7"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M14.1 15.3c3.4-.3 7-.4 10.9-.4 3.8 0 7.5.2 10.9.4.4-.4.7-.8.9-1.1C39 8.5 38.9 6.5 38.9 6c-.2-4.4-8.4-5-12.1-5h0-3.4c-3.7 0-12 .5-12.1 5 0 .5-.1 2.5 2.1 8.2 0 .3.3.8.7 1.1z"/></svg>`; ]]]
                        styles: &icon_hue_styles
                          custom_fields:
                            icon_hue:
                              [top: 11%, left: 4.5%, width: 3.05vw, position: absolute]
                        template: ['base','light']
                  
                  - type: horizontal-stack
                    cards:
                      - type: custom:mini-media-player
                        entity: media_player.kitchen_display
                        info: scroll
                        artwork: cover
            
                
